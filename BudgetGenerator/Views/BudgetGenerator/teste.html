@model BudgetGenerator.Models.ReportModel

@{
Layout = null;
var featureCounter = 1;

Func<int, string> displayOrEmpty = value => value > 0 ? value.ToString() : "";
    }

    <!DOCTYPE html>
    <html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="~/css/report.css">
        <title>Budget Generator</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                font-family: Calibri, Tahoma, sans-serif;
                font-size: 1.949rem;
            }

            :root {
                font-size: 62.5%;
            }

            body {
                padding: 3rem 1rem 0 1rem;
            }

            .report-cover {
                min-height: 105rem;
                padding-top: 15%;
            }

            .initial-page-footer {
                position: relative;
                height: 5rem;
                padding-top: 5%;
                width: 100%;
            }

            .line-footer {
                border-top: solid #d2d2d2 0.3rem;
                width: 100%;
                position: absolute;
                bottom: -2%;
                padding-top: 0.3%;
            }

            .body-report {
                padding-top: 14rem;
            }

            .body-report h1 {
                margin-bottom: 7.5rem;
                margin-left: 4.5rem;
                color: #172b4c;
                font-size: 2.9rem;
                font-weight: 100;
            }

            .body-report p {
                text-align: justify;
            }

            .description-feature {
                padding-left: 6.2rem;
            }

            li {
                margin-left: 5.1rem;
                margin-bottom: 0.3rem;
                list-style-position: outside;
                padding-left: 1.28rem;
            }

            .container-logo-report {
                width: 100%;
                height: 85rem;
            }

            .container-logo-report img {
                height: 100%;
                object-fit: contain;
            }

            .feature-container {
                margin-bottom: 3.8rem;
                margin-left: 2%;
                font-size: 16px;
            }

            .initial-page-footer p {
                font-size: 2.5rem;
                text-align: right;
                padding-right: 8.5%;
                margin-top: 2%;
            }

            .section-table {
                width: 100%;
                padding: 5px;
            }

            .development-budget-table,
            .test-budget-table,
            .table-resume-report-hours {
                width: 100%;
                border-collapse: collapse;
                background-color: #fff;
                font-family: Calibri, sans-serif;
                box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
                margin: 7% 0 0 0;
            }

            .test-budget-table {
                margin-bottom: 5%;
            }

            .development-budget-table th,
            .development-budget-table td,
            .test-budget-table th,
            .test-budget-table td,
            .table-resume-report-hours td,
            .table-resume-report-hours th {
                border: 1px solid #d2d2d2;
                background-color: #fff;
                font-size: 1.8rem;
                font-weight: 300;
                padding: 10px;
            }

            .developement-reference-hour,
            .total-value,
            .development-budget-table .text-head p {
                text-align: center;
            }

            .developement-category,
            .developement-item {
                font-size: 2rem;
            }

            .development-budget-table .title-table-head,
            .test-budget-table .title-table-head {
                background-color: #d2d2d2;
                font-weight: bold;
                text-align: center;
                font-size: 0.7em;
            }

            .development-budget-table .dev-data,
            .test-budget-table .dev-data {
                width: 15rem;
            }

            .development-budget-table .developement-activities {
                width: 40rem;
            }

            .category-colum {
                text-align: center;
            }

            .service-complexity {
                text-align: center;
            }

            .development-budget-table tbody td,
            .test-budget-table tbody td {
                background-color: #fff;
            }

            .development-budget-table .table-header,
            .test-budget-table .table-header {
                text-align: center;
            }

            .developer-item {
                width: 20rem;
            }

            .development-budget-table tbody tr:nth-child(even),
            .test-budget-table tbody tr:nth-child(even) {
                background-color: #d2d2d2;
            }

            .page-break {
                page-break-before: always;
                display: block;
                height: 0;
                visibility: hidden;
            }

            .table-resume-report-hours .table-resume-report-hours .header-td {
                font-weight: 700;
            }
        </style>
    </head>

    <body>
        <div class="report-cover">

            <div class="container-logo-report" align="center">
                <img src="~/images/logo-report.jpg" alt="">
            </div>
        </div>

        <div class="initial-page-footer">
            <div class="line-footer">
                <p>DOCUMENTAÇÃO FUNCIONAL DO SISTEMA</p>
            </div>
        </div>

        <div class="body-report">
            <h1>@Model.ReportTitle</h1>
            <div class="features-container">

                @foreach (var feature in Model.Features)
                {
                List<string> serviceList = new List<string>();
                        <div class="feature-container">
                            <p>Funcionalidade @featureCounter: @feature.Name (@Model.GetBudgetedDevelopmentHours)</p>
                            <ul>
                                @foreach (var service in feature.Services.Where(s => s.Category.ToLower() == "operacao"
                                ||
                                s.Category.ToLower() == "integracao"))
                                {
                                serviceList.Add($"{service.ServiceType} {service.Complexity}");
                                }
                                @if (serviceList.Any())
                                {
                                string resultString = string.Join(" + ", serviceList);
                                <li class="services-list">@resultString</li>
                                }
                            </ul>
                            <p class="description-feature">@feature.Description</p>
                        </div>
                        featureCounter++;
                        }
            </div>
            <div class="page-break"></div>
            @if (Model.HasOperationServices())
            {
            <div class="section-table" align="center">
                <table class="development-budget-table">
                    <thead>
                        <tr>
                            <th class="title-table-head" colspan="10">Matriz de orçamento para desenvolvimento</th>
                        </tr>
                        <tr>
                            <th colspan="2"></th>
                            <th colspan="3" class="text-head">
                                <p>Valores de referência</p>
                                <p>(Horas)</p>
                            </th>
                            <th colspan="3" class="text-head">
                                <p>Operações do projeto</p>
                                <p>(Quantidade)</p>
                            </th>
                            <th colspan="2" rowspan="2" class="text-head">
                                <p>Total</p>
                                <p>(Horas)</p>
                            </th>
                        </tr>
                        <tr>
                            <th class="table-header">Categoria</th>
                            <th class="table-header">Item</th>
                            <th class="table-header">Simples</th>
                            <th class="table-header">Médio</th>
                            <th class="table-header">Complexo</th>
                            <th class="table-header">Simples</th>
                            <th class="table-header">Médio</th>
                            <th class="table-header">Complexo</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Linha para Telas WEB -->
                        <tr>
                            <td class="category-colum">
                                <span class="developement-category">Telas</span>
                            </td>
                            <td class="dev-data">
                                <span class="developement-item">WEB</span>
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.telas.web.facil.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.telas.web.medio.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.telas.web.complexo.horas")
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "telas" && s.ServiceType.ToLower() == "web" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "telas" && s.ServiceType.ToLower() == "web" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "telas" && s.ServiceType.ToLower() == "web" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="total-value">
                                @Model.CalculateTotalHoursPerItem("operacoes", "telas", "web")
                            </td>
                        </tr>
                        <!-- Linha para Relatórios PDF -->
                        <tr>
                            <td rowspan="2" class="category-colum">
                                <span class="developement-category">Relatórios</span>
                            </td>
                            <td class="dev-data">
                                <span class="developement-item">PDF</span>
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.relatorios.pdf.facil.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.relatorios.pdf.medio.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.relatorios.pdf.complexo.horas")
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "relatorios" && s.ServiceType.ToLower() == "pdf" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "relatorios" && s.ServiceType.ToLower() == "pdf" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "relatorios" && s.ServiceType.ToLower() == "pdf" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="total-value">
                                @Model.CalculateTotalHoursPerItem("operacoes", "relatorios", "pdf")
                            </td>
                        </tr>
                        <tr>
                            <td class="dev-data">
                                <p class="developement-item">Excel / Word</p>
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.relatorios.excel_word.facil.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.relatorios.excel_word.medio.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.relatorios.excel_word.complexo.horas")
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "relatorios" && s.ServiceType.ToLower() == "excel_word"
                                &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "relatorios" && s.ServiceType.ToLower() == "excel_word"
                                &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "relatorios" && s.ServiceType.ToLower() == "excel_word"
                                &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="total-value">
                                @Model.CalculateTotalHoursPerItem("operacoes", "relatorios", "excel_word")
                            </td>
                        </tr>
                        <tr>
                            <td rowspan="6" class="category-colum">
                                <span class="developement-category">SQL</span>
                            </td>
                            <td class="dev-data">
                                <span class="developement-item">Procedure</span>
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.procedure.facil.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.procedure.medio.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.procedure.complexo.horas")
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "procedure" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "procedure" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "procedure" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="total-value">
                                @Model.CalculateTotalHoursPerItem("operacoes", "sql", "procedure")
                            </td>
                        </tr>
                        <!-- SQL Job -->
                        <tr>
                            <td class="dev-data">
                                <span class="developement-item">JOB</span>
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.job.facil.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.job.medio.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.job.complexo.horas")
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "job" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "job" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "job" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="total-value">
                                @Model.CalculateTotalHoursPerItem("operacoes", "sql", "job")
                            </td>
                        </tr>
                        <!-- SQL Trigger -->
                        <tr>
                            <td class="dev-data">
                                <span class="developement-item">Trigger</span>
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.trigger.facil.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.trigger.medio.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.trigger.complexo.horas")
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "trigger" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "trigger" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "trigger" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="total-value">
                                @Model.CalculateTotalHoursPerItem("operacoes", "sql", "trigger")
                            </td>
                        </tr>
                        <tr>
                            <td class="dev-data">
                                <span class="developement-item">Função</span>
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.funcao.facil.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.funcao.medio.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.funcao.complexo.horas")
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "funcao" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "funcao" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "funcao" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="total-value">
                                @Model.CalculateTotalHoursPerItem("operacoes", "sql", "funcao")
                            </td>
                        </tr>

                        <tr>
                            <td class="dev-data">
                                <span class="developement-item">Scripts</span>
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.scripts.facil.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.scripts.medio.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.scripts.complexo.horas")
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "scripts" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "scripts" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "scripts" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="total-value">
                                @Model.CalculateTotalHoursPerItem("operacoes", "sql", "scripts")
                            </td>
                        </tr>
                        <!-- SQL Modelagem -->
                        <tr>
                            <td class="dev-data">
                                <span class="developement-item">Modelagem</span>
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.modelagem.facil.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.modelagem.medio.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.sql.modelagem.complexo.horas")
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "modelagem" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "modelagem" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "modelagem" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="total-value">
                                @Model.CalculateTotalHoursPerItem("operacoes", "sql", "modelagem")
                            </td>
                        </tr>

                        <!-- API Operação -->
                        <tr>
                            <td class="category-colum">
                                <span class="developement-category">Api</span>
                            </td>
                            <td class="dev-data">
                                <span class="developement-item">Operação</span>
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.api.operacao.facil.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.api.operacao.medio.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.api.operacao.complexo.horas")
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "api" && s.ServiceType.ToLower() == "operacao" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "api" && s.ServiceType.ToLower() == "operacao" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "api" && s.ServiceType.ToLower() == "operacao" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="total-value">
                                @Model.CalculateTotalHoursPerItem("operacoes", "api", "operacao")
                            </td>
                        </tr>

                        <!-- Serviços Console -->
                        <tr>
                            <td class="category-colum">
                                <span class="developement-category">Serviços</span>
                            </td>
                            <td class="dev-data">
                                <span class="developement-item">Console</span>
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.servicos.console.facil.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.servicos.console.medio.horas")
                            </td>
                            <td class="developement-reference-hour">
                                @Model.ReferenceMatrix.SelectToken("operacoes.servicos.console.complexo.horas")
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "servicos" && s.ServiceType.ToLower() == "console" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "servicos" && s.ServiceType.ToLower() == "console" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "servicos" && s.ServiceType.ToLower() == "console" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "operacoes"))
                            </td>
                            <td class="total-value">
                                @Model.CalculateTotalHoursPerItem("operacoes", "servicos", "console")
                            </td>
                        </tr>

                    </tbody>
                </table>
            </div>
            }
            @if (Model.HasTestServices())
            {
            <div class="page-break"></div>
            <div class="section-table" align="center">
                <table class="test-budget-table">
                    <thead>
                        <tr>
                            <th class="title-table-head" colspan="5">Matriz de orçamento para Testes</th>
                        </tr>
                        <tr>
                            <th class="table-header">Categoria</th>
                            <th class="table-header">Item</th>
                            <th class="table-header">Simples</th>
                            <th class="table-header">Médio</th>
                            <th class="table-header">Complexo</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Linha para Telas WEB -->
                        <tr>
                            <td class="category-colum">
                                <span class="developement-category">Telas</span>
                            </td>
                            <td class="dev-data">
                                <span class="developement-item">WEB</span>
                            </td>
                            <td class="developement
                                <td class=" service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "telas" && s.ServiceType.ToLower() == "web" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "telas" && s.ServiceType.ToLower() == "web" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "telas" && s.ServiceType.ToLower() == "web" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "testes"))
                            </td>
                        </tr>

                        <!-- Linha para Relatórios PDF -->
                        <tr>
                            <td rowspan="2" class="category-colum">
                                <span class="developement-category">Relatórios</span>
                            </td>
                            <td class="dev-data">
                                <span class="developement-item">PDF</span>
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "relatorios" && s.ServiceType.ToLower() == "pdf" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "relatorios" && s.ServiceType.ToLower() == "pdf" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "relatorios" && s.ServiceType.ToLower() == "pdf" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "testes"))
                            </td>
                        </tr>
                        <tr>
                            <td class="dev-data">
                                <p class="developement-item">Excel / Word</p>
                            </td>

                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "relatorios" && s.ServiceType.ToLower() == "excel_word"
                                &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "relatorios" && s.ServiceType.ToLower() == "excel_word"
                                &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "relatorios" && s.ServiceType.ToLower() == "excel_word"
                                &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "testes"))
                            </td>
                        </tr>
                        <tr>
                            <td rowspan="6" class="category-colum">
                                <span class="developement-category">SQL</span>
                            </td>
                            <td class="dev-data">
                                <span class="developement-item">Procedure</span>
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "procedure" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "procedure" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "procedure" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "testes"))
                            </td>
                        </tr>

                        <!-- SQL Job -->
                        <tr>
                            <td class="dev-data">
                                <span class="developement-item">JOB</span>
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "job" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "job" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "job" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "testes"))
                            </td>
                        </tr>

                        <!-- SQL Trigger -->
                        <tr>
                            <td class="dev-data">
                                <span class="developement-item">Trigger</span>
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "trigger" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "trigger" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "trigger" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "testes"))
                            </td>
                        </tr>
                        <!-- SQL Função -->
                        <tr>
                            <td class="dev-data">
                                <span class="developement-item">Função</span>
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "funcao" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "funcao" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "funcao" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "testes"))
                            </td>
                        </tr>
                        <!-- SQL Scripts -->
                        <tr>
                            <td class="dev-data">
                                <span class="developement-item">Scripts</span>
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "scripts" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "scripts" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "scripts" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "testes"))
                            </td>
                        </tr>
                        <!-- SQL Modelagem -->
                        <tr>
                            <td class="dev-data">
                                <span class="developement-item">Modelagem</span>
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "modelagem" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "modelagem" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "sql" && s.ServiceType.ToLower() == "modelagem" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "testes"))
                            </td>
                        </tr>

                        <!-- API Operação -->
                        <tr>
                            <td class="category-colum">
                                <span class="developement-category">Api</span>
                            </td>
                            <td class="dev-data">
                                <span class="developement-item">Operação</span>
                            </td>

                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "api" && s.ServiceType.ToLower() == "operacao" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "api" && s.ServiceType.ToLower() == "operacao" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "api" && s.ServiceType.ToLower() == "operacao" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "testes"))
                            </td>
                        </tr>

                        <!-- Serviços Console -->
                        <tr>
                            <td class="category-colum">
                                <span class="developement-category">Serviços</span>
                            </td>
                            <td class="dev-data">
                                <span class="developement-item">Console</span>
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "servicos" && s.ServiceType.ToLower() == "console" &&
                                s.Complexity.ToLower() == "facil" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "servicos" && s.ServiceType.ToLower() == "console" &&
                                s.Complexity.ToLower() == "medio" && s.Category.ToLower() == "testes"))
                            </td>
                            <td class="service-complexity">
                                @displayOrEmpty(Model.Features.SelectMany(f => f.Services)
                                .Count(s => s.Area.ToLower() == "servicos" && s.ServiceType.ToLower() == "console" &&
                                s.Complexity.ToLower() == "complexo" && s.Category.ToLower() == "testes"))
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            }
        </div>
        <table class="table-resume-report-hours">
            <tr>
                <td class="header-td">Total de Horas Análise e Levantamento:</td>
                <td>@Model.AnalysisHours horas</td>
            </tr>
            <tr>
                <td class="header-td">Total de Horas Desenvolvimento:</td>
                <td>@Model.GetBudgetedDevelopmentHours horas</td>
            </tr>
            <tr>
                <td class="header-td">Total de Horas Testes:</td>
                <td>@Model.GetTotalTestHours horas</td>
            </tr>
            <tr>
                <td class="header-td">Total de Horas Previstas para Homologação e Acompanhamento em Produção:</td>
                <td>Apontamento</td>
            </tr>
            <tr>
                <td class="header-td">Total Geral:</td>
                <td>@Model.GetTotalReportHours horas</td>
            </tr>
            <tr>
                <td class="header-td">teste:</td>
                <td class="service-complexity">
                    @Model.ReferenceMatrix.SelectToken("operacoes.telas.web.facil.horas")
                </td>
            </tr>
        </table>



    </body>


    </body>

    </html>